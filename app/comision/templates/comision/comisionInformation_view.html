{% extends "base_template.html" %}

{% block title %} Consultar comisión {% endblock %}

{% block content %}
<div class="container mt-3">
  {% with messages = get_flashed_messages(with_categories=True)  %}
      {% if messages %}
        {% for category, message in messages %}
        {% if category == 'success' %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        {% elif category == 'error' %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        {% endif %}
        {% endfor %}
      {% endif %}
    {% endwith %}
    <div class="card mb-3">
      <div class="card-body">
        <h4 class="card-title mb-4">Datos comisión</h4>
        <div class="row">
          <div class="col">
            <p class="card-text"><strong>Nombre:</strong> {{ comision.nombre }}</p>
            <p class="card-text d-grid mt-3 mb-3"><strong>Comentarios:</strong> {{ comision.comentarios }}</p>
          </div>
          <div class="col">
            <p class="card-text"><strong>Fecha de apertura: </strong> {{ comision.fecha_apertura | datetime }}</p>
            {% if comision.fecha_cierre %}
            <p class="card-text mt-3 mb-3"><strong>Fecha de cierre: </strong> {{ comision.fecha_cierre |datetime }}</p>
            {% endif %}
          </div>
          <h5 class="my-4">Composición</h5>
          {% if not miembros_comision %}
          <p>Esta comisión no posee actualmente ningún miembro</p>
          {% else %}
          <div class="member-list">
            {% for miembro in miembros_comision %}
            <div class="member-card">
                <h5 class="card-title"><strong>{{ miembro[1] }}</strong></h5>
                <p class="card-text">&emsp;Fecha incorporación: {{ miembro[2] | datetime }}</p>
                <p class="card-text">&emsp;Fecha de baja: {% if miembro[3] %} {{ miembro[3] | datetime }} {% else %} El miembro actualmente sigue dado de alta {% endif %}</p>
            </div>
            {% endfor %}
          </div>
          {% endif %}
          <div class="mt-4">
            <a href="{{url_for('comision.update_comision', id_comision=comision.id, miembros_comision=miembros_comision)}}" class="btn btn-primary member-button">Editar comisión</a>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}